document.querySelector('.todo-section').style.display = 'none';
document.querySelector('.exam-options').style.display = 'block';
popup.classList.add('active');
}
                    });
                });
            }
            
            // Month navigation
            document.getElementById('prevMonth').addEventListener('click', function() {
                currentDate.setMonth(currentDate.getMonth() - 1);
                updateCalendar();
            });
            
            document.getElementById('nextMonth').addEventListener('click', function() {
                currentDate.setMonth(currentDate.getMonth() + 1);
                updateCalendar();
            });
            
            // Close popup
            document.getElementById('closePopup').addEventListener('click', function() {
                document.getElementById('dayPopup').classList.remove('active');
            });
            
            // Close popup when clicking outside
            document.getElementById('dayPopup').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
            
            // Todo list functionality
            const todoItems = [
                { text: "Preparare riassunto capitolo 3", completed: false },
                { text: "Ripassare formule di statistica", completed: true },
                { text: "Completare esercizi di probabilità", completed: false }
            ];
            
            function renderTodoList() {
                const todoList = document.getElementById('todoList');
                todoList.innerHTML = '';
                
                todoItems.forEach((item, index) => {
                    const li = document.createElement('li');
                    li.className = `todo-item ${item.completed ? 'checked' : ''}`;
                    
                    const checkbox = document.createElement('div');
                    checkbox.className = `todo-checkbox ${item.completed ? 'checked' : ''}`;
                    checkbox.addEventListener('click', () => toggleTodoItem(index));
                    
                    const text = document.createElement('div');
                    text.className = 'todo-text';
                    text.textContent = item.text;
                    
                    const deleteBtn = document.createElement('div');
                    deleteBtn.className = 'todo-delete';
                    deleteBtn.innerHTML = '×';
                    deleteBtn.addEventListener('click', () => deleteTodoItem(index));
                    
                    li.appendChild(checkbox);
                    li.appendChild(text);
                    li.appendChild(deleteBtn);
                    todoList.appendChild(li);
                });
            }
            
            function toggleTodoItem(index) {
                todoItems[index].completed = !todoItems[index].completed;
                renderTodoList();
            }
            
            function deleteTodoItem(index) {
                todoItems.splice(index, 1);
                renderTodoList();
            }
            
            document.getElementById('addTodoBtn').addEventListener('click', addNewTodo);
            document.getElementById('newTodoInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addNewTodo();
                }
            });
            
            function addNewTodo() {
                const input = document.getElementById('newTodoInput');
                const text = input.value.trim();
                
                if (text) {
                    todoItems.push({ text, completed: false });
                    input.value = '';
                    renderTodoList();
                }
            }
            
            // Setup exam option buttons
            const examButtons = document.querySelectorAll('.exam-btn');
            examButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    alert(`Hai selezionato un esame ${this.textContent}. La configurazione sarà applicata al 20 Maggio.`);
                    document.getElementById('dayPopup').classList.remove('active');
                });
            });
            
            // Initialize
            updateProgressBar();
            updateCalendar();
            renderTodoList();
        });